<!DOCTYPE html>
<html>
  <head>
    <title>three.js</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <style>
      a {
        color: red;
      }

      body {
        background-color: #111;
      }

      #menu {
        position: absolute;
        bottom: 20px;
        width: 100%;
        text-align: center;
      }

      .element {
        cursor: default;
      }

      .element img {
        background-color: red;
      }

      .element:hover {
        box-shadow: 0px 0px 30px white;
        border: 1px solid white;
      }

      button {
        color: white;
        background: transparent;
        outline: 1px solid white;
        border: 0px;
        padding: 5px 10px;
        cursor: pointer;
      }

      button:hover {
        background-color: white;
      }

      button:active {
        color: #000000;
        background-color: white;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.7);
      }

      .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 600px;
        text-align: center;
        position: relative;
      }

      .modal-close {
        font-size: 24px;
        cursor: pointer;
        position: absolute;
        top: 10px;
        right: 20px;
      }

      .modal-text {
        margin-top: 20px;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <div id="menu">
      <button id="sphere">SPHERE</button>
      <button id="helix">HELIX</button>
    </div>

    <div id="modal" class="modal">
      <div id="modal-content" class="modal-content">
        <span id="modal-close" class="modal-close">&times;</span>
        <div id="modal-text" class="modal-text"></div>
        <a href="" id="modal-link" class="modal-link"></a>
      </div>
    </div>

    <script
      async
      src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"
    ></script>

    <script type="importmap">
      {
        "imports": {
          "three": "../three/three.module.js",
          "three/addons/": "./jsm/"
        }
      }
    </script>

    <script type="module">
      import * as THREE from "three";

      import TWEEN from "three/addons/libs/tween.module.js";
      import { TrackballControls } from "three/addons/controls/TrackballControls.js";
      import {
        CSS3DRenderer,
        CSS3DObject,
      } from "three/addons/renderers/CSS3DRenderer.js";

      const table = [
        {
          id: "1",
          img: "dog",
          name: "google",
        },
        {
          id: "2",
          img: "dog",
          name: "facebook",
        },
        {
          id: "3",
          img: "dog",
          name: "youtube",
        },
        {
          id: "4",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "5",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "6",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
        {
          id: "1",
          img: "dog",
          name: "DOGggg",
        },
      ];

      let camera, scene, renderer;
      let controls;

      const objects = [];
      const targets = { table: [], sphere: [], helix: [], grid: [] };

      init();
      animate();

      function init() {
        camera = new THREE.PerspectiveCamera(
          45,
          innerWidth / innerHeight,
          1,
          2000
        );
        camera.position.z = 10000;

        scene = new THREE.Scene();

        const vector = new THREE.Vector3();

        for (let i = 0; i < table.length; i += 1) {
          const element = document.createElement("div");
          element.className = "element";

          const image = document.createElement("img");
          image.src = "./thumb/" + table[i].img + ".jpg";
          image.style.width = "320px";
          image.style.height = "240px";
          image.style.backgroundSize = "cover";
          element.appendChild(image);

          // Add an event listener to the element
          element.addEventListener("mousedown", () => {
            const modal = document.getElementById("modal");
            const modalLink = document.getElementById("modal-link");
            const modalText = document.getElementById("modal-text");
            const modalButtonClose = document.getElementById("modal-close");

            // Set the text in the modal
            modalText.textContent = table[i].name;
            modalLink.href = table[i].id;
            modalLink.textContent = `Visit to ${table[i].name}`;

            // Show the modal
            modal.style.display = "block";

            modalLink.addEventListener("mousedown", function (event) {
              window.open(modalLink.href, "youtube");
            });

            // Close the modal when clicking the close button
            modalButtonClose.addEventListener("mousedown", () => {
              modal.style.display = "none";
            });
          });

          const objectCSS = new CSS3DObject(element);
          scene.add(objectCSS);

          objects.push(objectCSS);

          //

          const object = new THREE.Object3D();
          object.position.x = table[i + 1] * 360 - 1600;
          object.position.y = -(table[i + 2] * 280) + 990;

          targets.table.push(object);
        }

        // sphere

        for (let i = 0, l = objects.length; i < l; i++) {
          const phi = Math.acos(-1 + (2 * i) / l);
          const theta = Math.sqrt(l * Math.PI) * phi;

          const object = new THREE.Object3D();

          object.position.setFromSphericalCoords(1500, phi, theta);

          vector.copy(object.position).multiplyScalar(2);

          object.lookAt(vector);

          targets.sphere.push(object);
        }

        // helix

        for (let i = 0, l = objects.length; i < l; i++) {
          const theta = i * 0.28 + Math.PI;
          const y = -(i * 15) + 1200;

          const object = new THREE.Object3D();

          object.position.setFromCylindricalCoords(2000, theta, y);

          vector.x = object.position.x * 2;
          vector.y = object.position.y;
          vector.z = object.position.z * 2;

          object.lookAt(vector);

          targets.helix.push(object);
        }

        // grid

        for (let i = 0; i < objects.length; i++) {
          const object = new THREE.Object3D();

          object.position.x = (i % 4) * 500 - 800;
          object.position.y = -(Math.floor(i / 4) % 4) * 500 + 800;
          object.position.z = Math.floor(i / 16) * 1000 - 2000;

          targets.grid.push(object);
        }

        //

        renderer = new CSS3DRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById("container").appendChild(renderer.domElement);

        //

        controls = new TrackballControls(camera, renderer.domElement);
        controls.minDistance = 500;
        controls.maxDistance = 6000;
        controls.addEventListener("change", render);

        const buttonSphere = document.getElementById("sphere");
        buttonSphere.addEventListener("click", function () {
          transform(targets.sphere, 1000);
        });

        const buttonHelix = document.getElementById("helix");
        buttonHelix.addEventListener("click", function () {
          transform(targets.helix, 1000);
        });

        transform(targets.sphere, 1000);

        //
      }
      window.addEventListener("resize", onWindowResize);

      function transform(targets, duration) {
        TWEEN.removeAll();

        for (let i = 0; i < objects.length; i++) {
          const object = objects[i];
          const target = targets[i];

          new TWEEN.Tween(object.position)
            .to(
              {
                x: target.position.x,
                y: target.position.y,
                z: target.position.z,
              },
              Math.random() * duration + duration
            )
            .easing(TWEEN.Easing.Exponential.InOut)
            .start();

          new TWEEN.Tween(object.rotation)
            .to(
              {
                x: target.rotation.x,
                y: target.rotation.y,
                z: target.rotation.z,
              },
              Math.random() * duration + duration
            )
            .easing(TWEEN.Easing.Exponential.InOut)
            .start();
        }

        new TWEEN.Tween(this)
          .to({}, duration * 2)
          .onUpdate(render)
          .start();
      }

      function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize(window.innerWidth, window.innerHeight);

        render();
      }

      function animate() {
        requestAnimationFrame(animate);

        TWEEN.update();

        controls.update();
      }

      function render() {
        renderer.render(scene, camera);
      }
    </script>
  </body>
</html>
